<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pearlbot</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #e0f2ff, #c7e0ff);
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  .chatbot {
    width: 100%;
    max-width: 450px;
    height: 90vh;
    max-height: 700px;
    background: #fff;
    border-radius: 20px;
    display: flex;
    flex-direction: column;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    overflow: hidden;
    transition: transform 0.3s ease;
  }

  .chatbot:hover {
    transform: translateY(-4px);
  }

  .header {
    background: linear-gradient(90deg, #0d6efd, #6610f2);
    color: #fff;
    padding: 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header strong { font-size: 1.1rem; }
  .weather {
    font-size: 0.8rem;
    text-align: right;
    line-height: 1.2;
  }

  .messages {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    background: #f9fafb;
  }

  .message {
    display: flex;
    margin-bottom: 12px;
    opacity: 0;
    transform: translateY(20px);
    animation: fadeSlideIn 0.5s ease forwards;
  }
  .message.user { justify-content: flex-end; }

  .bubble {
    padding: 10px 15px;
    border-radius: 18px;
    max-width: 80%;
    font-size: 0.95rem;
  }
  .user .bubble {
    background: #0d6efd;
    color: #fff;
    border-bottom-right-radius: 4px;
  }
  .bot .bubble {
    background: #e5e7eb;
    color: #111;
    border-bottom-left-radius: 4px;
  }

  @keyframes fadeSlideIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .typing-indicator {
    background: #e5e7eb;
    padding: 10px 14px;
    border-radius: 18px;
    display: inline-flex;
    align-items: center;
    margin-bottom: 10px;
    animation: fadeSlideIn 0.4s ease forwards;
  }

  .typing-dots span {
    height: 8px;
    width: 8px;
    background: #555;
    border-radius: 50%;
    margin: 0 2px;
    animation: blink 1.4s infinite both;
  }

  .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
  .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

  @keyframes blink {
    0%, 80%, 100% { opacity: 0.2; }
    40% { opacity: 1; }
  }

  .quick-actions {
    padding: 10px;
    border-top: 1px solid #e5e7eb;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    background: #fff;
  }

  .input-group {
    border-top: 1px solid #e5e7eb;
    background: #fff;
    padding: 10px;
  }

  .input-group input {
    border-radius: 20px 0 0 20px;
  }

  .input-group .btn {
    border-radius: 0 20px 20px 0;
  }

  .map-area {
    height: 300px;
  }

  @media (max-width: 600px) {
    .chatbot {
      height: 100vh;
      max-height: none;
      border-radius: 0;
    }
    .messages {
      padding: 12px;
    }
  }
</style>
</head>
<body>
<div class="chatbot">
  <div class="header">
    <div>
      <strong>PearlBot</strong><br>
      <small>Your travel guide ‚úàÔ∏è</small>
    </div>
    <div class="weather" id="weatherBox">
      üå§Ô∏è 28¬∞C<br>üíß Humidity: 70%
    </div>
  </div>

  <div class="messages" id="messages"></div>

  <div class="quick-actions">
    <button class="btn btn-outline-primary btn-sm" onclick="quick('flight status')">Flight status</button>
    <button class="btn btn-outline-primary btn-sm" onclick="quick('directions to gate 5')">Gate 5 Directions</button>
    <button class="btn btn-outline-primary btn-sm" onclick="quick('restaurants nearby')">Restaurants</button>
    <button class="btn btn-outline-primary btn-sm" onclick="quick('transport to Kampala')">Transport</button>
  </div>

  <div class="input-group">
    <input id="input" type="text" class="form-control" placeholder="Ask about flights, navigation, or weather...">
    <button class="btn btn-primary" id="sendBtn">Send</button>
  </div>
</div>

<!-- Map Modal -->
<div class="modal fade" id="mapModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Entebbe Airport Map</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div id="map" class="map-area"></div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const messagesEl = document.getElementById('messages');
const input = document.getElementById('input');
const sendBtn = document.getElementById('sendBtn');

function pushMessage(text, who='bot') {
  const wrap = document.createElement('div');
  wrap.className = 'message ' + who;
  const bubble = document.createElement('div');
  bubble.className = 'bubble';
  bubble.innerHTML = text;
  wrap.appendChild(bubble);
  messagesEl.appendChild(wrap);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function showTyping() {
  const t = document.createElement('div');
  t.className = 'typing-indicator';
  t.id = 'typing';
  t.innerHTML = '‚úàÔ∏è Assistant is typing <div class="typing-dots"><span></span><span></span><span></span></div>';
  messagesEl.appendChild(t);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function hideTyping() {
  const t = document.getElementById('typing');
  if (t) t.remove();
}

function userSend() {
  const val = input.value.trim();
  if (!val) return;
  pushMessage(val, 'user');
  input.value = '';
  handleQuery(val.toLowerCase());
}

sendBtn.onclick = userSend;
input.addEventListener('keydown', e => { if (e.key === 'Enter') userSend(); });
function quick(q){ input.value=q; userSend(); }

function handleQuery(q) {
  showTyping();
  setTimeout(() => {
    hideTyping();

    if (q.includes('flight')) {
      pushMessage('Here‚Äôs an example of flight updates:<br>‚úàÔ∏è KQ432 ‚Äî Departed<br>‚úàÔ∏è QR324 ‚Äî Landed<br>‚úàÔ∏è UG123 ‚Äî On Time');
    } 
    else if (q.includes('weather')) {
      pushMessage('üå§Ô∏è Current weather in Entebbe: 28¬∞C, humidity 70%, light breeze from Lake Victoria.');
    } 
    else if (q.includes('gate')) {
      pushMessage('üß≠ Follow signs from the main hall ‚Üí turn left ‚Üí proceed 100m to Gate 5.');
      openMap();
    } 
    else if (q.includes('restaurant')) {
      pushMessage('üç¥ Nearest restaurants: Java House (Departures), Caf√© Javas (Arrivals), Victoria Lounge.');
    }
    else if (q.includes('kampala') || q.includes('transport')) {
      pushMessage('üöó Options: Airport Taxi (UGX 80k‚Äì120k), Shuttle (45 mins), or Airport Express Bus.');
    } 
    else {
      pushMessage('I can assist with flights, weather, gates, restaurants, and transport üöñ');
    }

  }, 1200);
}

// Map
let mapInit = false;
function openMap(){
  const mapModal = new bootstrap.Modal(document.getElementById('mapModal'));
  mapModal.show();
  if (!mapInit) {
    setTimeout(() => {
      const map = L.map('map').setView([0.0424,32.4435], 14);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap'
      }).addTo(map);
      L.marker([0.0424,32.4435]).addTo(map).bindPopup('üõ¨ Entebbe Intl Airport').openPopup();
      mapInit = true;
    }, 500);
  }
}

pushMessage('üëã Welcome to <strong>PearlBot!</strong><br>Ask me about flights, weather, or navigation.');
</script>
</body>
</html>
